<div class="plyr_block">
    <style scoped>
	.plyr {
	    --plyr-color-main: #4FD2C2;
	    --plyr-video-background: #0B3D3C;
	    --shadow-color: 197deg 32% 65%;
	    border-radius: 12px;
	    box-shadow: 0 .5px .6px hsl(var(--shadow-color)/.36),0 1.7px 1.9px -.8px hsl(var(--shadow-color)/.36),0 4.3px 4.8px -1.7px hsl(var(--shadow-color)/.36),-.1px 10.6px 11.9px -2.5px hsl(var(--shadow-color)/.36);
	}

        .w-full {
                width: 100%
        }
    </style>
    <video id="video-player" class="plyr w-full" controls width="100%" height="400"></video>
    {% if allow_download or source_url != "" %}
    <ul>
        {% if allow_download %}
        <li class="video-download-button">
            <a href="{{ url }}" download>Download the video</a>
        </li>
        {% endif %}
        {% if source_url != "" %}
        <li class="video-download-button">
            <a href="{{ source_url }}" download>{% if source_text == "" %}Download the source
                document{% else %}{{ source_text }}{% endif %}</a>
        </li>
        {% endif %}
    </ul>
    {% endif %}
</div>
<script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/hls.js/1.4.3/hls.min.js"></script>
<script>
	let head = document.getElementsByTagName('HEAD')[0];
        let link = document.createElement('link');

        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.plyr.io/3.7.8/plyr.css'

        head.appendChild(link);

	document.addEventListener('DOMContentLoaded', () => {
		const source = "{{ url }}";

		const video = document.getElementById('video-player');
	
		// For more options see: https://github.com/sampotts/plyr/#options
		const player = new Plyr(video, {
			settings: ['quality', 'speed', 'loop']
		});
	
		if (!Hls.isSupported()) {
			video.src = source;
		} else {
		// For more Hls.js options, see https://github.com/dailymotion/hls.js
			const hls = new Hls();
			hls.loadSource(source);
			hls.attachMedia(video);
			window.hls = hls;
		}
	
		// Expose player so it can be used from the console
		window.player = player;

	});
</script>
